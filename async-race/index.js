(()=>{"use strict";var e={443:(e,t,n)=>{n.d(t,{Z:()=>o});var r=n(81),i=n.n(r),a=n(645),s=n.n(a)()(i());s.push([e.id,".header {\n  margin: 20px;\n}\n\n.header > button { background-color: rgba(4, 255, 150, 0.747);}\n.header > button:hover { background-color: rgb(4, 255, 150);}\n.header > button:active { background-color: rgba(4, 255, 150, 0.747);}\n\n.garage__btn {\n  padding: 2px 5px;\n}\n\n.winner__btn {\n  margin-left: 20px;\n  padding: 2px 5px;\n}\n\n.main {\n  display: flex;\n  flex-direction: column;\n  min-height: 300px;\n}\n",""]);const o=s},935:(e,t,n)=>{n.d(t,{Z:()=>o});var r=n(81),i=n.n(r),a=n(645),s=n.n(a)()(i());s.push([e.id,".car-administration {\n  display: flex;\n  flex-direction: column;\n  max-width: 320px;\n  width: 100%;\n  margin-left: 20px;\n}\n\n.car-administration_hide {\n  display: none;\n}\n\n.car-administration button {\n  padding: 2px 5px;\n}\n\n.cars-generate__btn-race,\n.cars-generate__btn-reset {\n  background-color: rgba(4, 255, 150, 0.747);\n}\n\n.cars-generate__btn-race:hover,\n.cars-generate__btn-reset:hover { background-color: rgb(4, 255, 150);}\n\n.car-administration button:active { background-color: rgba(4, 255, 150, 0.747);}\n\n\n.car-administration > * {\n  margin-top: 10px;\n  display: flex;\n  justify-content: space-between;\n}\n",""]);const o=s},267:(e,t,n)=>{n.d(t,{Z:()=>h});var r=n(81),i=n.n(r),a=n(645),s=n.n(a),o=n(667),c=n.n(o),d=new URL(n(477),n.b),l=s()(i()),u=c()(d);l.push([e.id,`.garage {\n  display: flex;\n  flex-direction: column;\n  margin: 20px;\n  color: aliceblue;\n}\n\n.garage_hide {\n  display: none;\n}\n\n.garage-title {\n  display: flex;\n}\n\n.garage-title__cars {\n  margin-left: 10px;\n}\n\n.pagination {\nmargin-top: 20px;\n}\n\n.pagination > button {\n  padding: 2px 5px;\n  margin-right: 10px;\n  background-color: rgba(4, 255, 150, 0.747);\n}\n.pagination > button:hover { background-color: rgb(4, 255, 150);}\n.pagination > button:active { background-color: rgba(4, 255, 150, 0.747);}\n\n\n.racing {\n  display: flex;\n  flex-direction: column;\n  position: relative;\n  min-height: 250px;\n  margin: 10px 0;\n}\n\n.car__title {\n  display: flex;\n}\n\n.field-race {\n  display: block;\n  width: 100%;\n  border-bottom: 4px dashed;\n  position: relative;\n  height: 54px;\n}\n\n.field-race::before {\n  content: "";\n  background-image: url(${u});\n  background-size: cover;\n  display: block;\n  position: absolute;\n  width: 50px;\n  height: 50px;\n  right: 100px;\n}\n\n.car__btn-remove {\n  margin: 0 10px;\n}\n\n.car__title {\n  margin: 10px 0;\n}\n\n.car__btn-start {\n  margin-right: 5px;\n}\n\n.car-icon {\n  position: absolute;\n  top: 0;\n  left: 0;\n}\n`,""]);const h=l},575:(e,t,n)=>{n.d(t,{Z:()=>o});var r=n(81),i=n.n(r),a=n(645),s=n.n(a)()(i());s.push([e.id,".winners {\n  display: none;\n  flex-direction: column;\n  margin: 20px;\n  color: aliceblue;\n}\n\n.winners_visible {\n  display: flex;\n}\n\n.winners-title {\n  display: flex;\n}\n\n.winners-title__cars {\n  margin-left: 10px;\n}\n\n.winners-list {\n  min-height: 150px;\n}\n\n.winners-pagination > button {\n  padding: 2px 5px;\n  margin-right: 10px;\n  background-color: rgba(4, 255, 150, 0.747);\n}\n.winners-pagination > button:hover { background-color: rgb(4, 255, 150);}\n.winners-pagination > button:active { background-color: rgba(4, 255, 150, 0.747);}\n\n.header-table tr{\n  background-color: aliceblue;\n  color: black;\n}\n\n.winners-list td{\n  padding-left: 10px;\n}\n",""]);const o=s},767:(e,t,n)=>{n.d(t,{Z:()=>o});var r=n(81),i=n.n(r),a=n(645),s=n.n(a)()(i());s.push([e.id,"* {\n  margin: 0;\n  padding: 0;\n}\n\nbody {\n  background-color: rgb(44, 44, 44);\n  display: flex;\n  flex-direction: column;\n  margin: 0;\n  padding: 0;\n  overflow-x: hidden;\n}\n\nbody button {\n  user-select: none;\n}\n",""]);const o=s},645:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",r=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),r&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),r&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,r,i,a){"string"==typeof e&&(e=[[null,e,void 0]]);var s={};if(r)for(var o=0;o<this.length;o++){var c=this[o][0];null!=c&&(s[c]=!0)}for(var d=0;d<e.length;d++){var l=[].concat(e[d]);r&&s[l[0]]||(void 0!==a&&(void 0===l[5]||(l[1]="@layer".concat(l[5].length>0?" ".concat(l[5]):""," {").concat(l[1],"}")),l[5]=a),n&&(l[2]?(l[1]="@media ".concat(l[2]," {").concat(l[1],"}"),l[2]=n):l[2]=n),i&&(l[4]?(l[1]="@supports (".concat(l[4],") {").concat(l[1],"}"),l[4]=i):l[4]="".concat(i)),t.push(l))}},t}},667:e=>{e.exports=function(e,t){return t||(t={}),e?(e=String(e.__esModule?e.default:e),/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),t.hash&&(e+=t.hash),/["'() \t\n]|(%20)/.test(e)||t.needQuotes?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e):e}},81:e=>{e.exports=function(e){return e[1]}},242:(e,t,n)=>{n.r(t),n.d(t,{default:()=>f});var r=n(379),i=n.n(r),a=n(795),s=n.n(a),o=n(569),c=n.n(o),d=n(565),l=n.n(d),u=n(216),h=n.n(u),p=n(589),m=n.n(p),v=n(443),g={};g.styleTagTransform=m(),g.setAttributes=l(),g.insert=c().bind(null,"head"),g.domAPI=s(),g.insertStyleElement=h(),i()(v.Z,g);const f=v.Z&&v.Z.locals?v.Z.locals:void 0},8:(e,t,n)=>{n.r(t),n.d(t,{default:()=>f});var r=n(379),i=n.n(r),a=n(795),s=n.n(a),o=n(569),c=n.n(o),d=n(565),l=n.n(d),u=n(216),h=n.n(u),p=n(589),m=n.n(p),v=n(935),g={};g.styleTagTransform=m(),g.setAttributes=l(),g.insert=c().bind(null,"head"),g.domAPI=s(),g.insertStyleElement=h(),i()(v.Z,g);const f=v.Z&&v.Z.locals?v.Z.locals:void 0},108:(e,t,n)=>{n.r(t),n.d(t,{default:()=>f});var r=n(379),i=n.n(r),a=n(795),s=n.n(a),o=n(569),c=n.n(o),d=n(565),l=n.n(d),u=n(216),h=n.n(u),p=n(589),m=n.n(p),v=n(267),g={};g.styleTagTransform=m(),g.setAttributes=l(),g.insert=c().bind(null,"head"),g.domAPI=s(),g.insertStyleElement=h(),i()(v.Z,g);const f=v.Z&&v.Z.locals?v.Z.locals:void 0},874:(e,t,n)=>{n.r(t),n.d(t,{default:()=>f});var r=n(379),i=n.n(r),a=n(795),s=n.n(a),o=n(569),c=n.n(o),d=n(565),l=n.n(d),u=n(216),h=n.n(u),p=n(589),m=n.n(p),v=n(575),g={};g.styleTagTransform=m(),g.setAttributes=l(),g.insert=c().bind(null,"head"),g.domAPI=s(),g.insertStyleElement=h(),i()(v.Z,g);const f=v.Z&&v.Z.locals?v.Z.locals:void 0},427:(e,t,n)=>{n.r(t),n.d(t,{default:()=>f});var r=n(379),i=n.n(r),a=n(795),s=n.n(a),o=n(569),c=n.n(o),d=n(565),l=n.n(d),u=n(216),h=n.n(u),p=n(589),m=n.n(p),v=n(767),g={};g.styleTagTransform=m(),g.setAttributes=l(),g.insert=c().bind(null,"head"),g.domAPI=s(),g.insertStyleElement=h(),i()(v.Z,g);const f=v.Z&&v.Z.locals?v.Z.locals:void 0},379:e=>{var t=[];function n(e){for(var n=-1,r=0;r<t.length;r++)if(t[r].identifier===e){n=r;break}return n}function r(e,r){for(var a={},s=[],o=0;o<e.length;o++){var c=e[o],d=r.base?c[0]+r.base:c[0],l=a[d]||0,u="".concat(d," ").concat(l);a[d]=l+1;var h=n(u),p={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==h)t[h].references++,t[h].updater(p);else{var m=i(p,r);r.byIndex=o,t.splice(o,0,{identifier:u,updater:m,references:1})}s.push(u)}return s}function i(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,i){var a=r(e=e||[],i=i||{});return function(e){e=e||[];for(var s=0;s<a.length;s++){var o=n(a[s]);t[o].references--}for(var c=r(e,i),d=0;d<a.length;d++){var l=n(a[d]);0===t[l].references&&(t[l].updater(),t.splice(l,1))}a=c}}},569:e=>{var t={};e.exports=function(e,n){var r=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},216:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},565:(e,t,n)=>{e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},795:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var i=void 0!==n.layer;i&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,i&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var a=n.sourceMap;a&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),t.styleTagTransform(r,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},589:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},900:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(){this.events={}}subscribe(e,t){this.events[e]||(this.events[e]=[]),this.events[e].push(t)}unsubscribe(e,t){const n=this.events[e];n&&(this.events[e]=n.filter((e=>e!==t)))}emit(e,t){const n=this.events[e];n&&n.forEach((e=>{e(t||void 0)}))}}},887:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),n(242);const i=r(n(900)),a=r(n(930)),s=r(n(858)),o=r(n(897)),c="http://127.0.0.1:3000";t.default=class{constructor(e){this.emitter=new i.default,this.carAdministrationController=new a.default(this.emitter,e,c),this.racingController=new s.default(this.emitter,e,c),this.winnersController=new o.default(this.emitter,e,c)}start(){}}},930:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(687));class a extends i.default{constructor(e,t,n){super(e,t,n),this.addListenerClickCarsCreate(),this.addListenerClickGenerateCars(),this.addListenerClickRaceOrReset(),this.emitter.subscribe("clickBtnSelect",(e=>{this.addListenerClickBtnUpdate(e)}))}addListenerClickCarsCreate(){var e;null===(e=document.querySelector(".cars-create__button"))||void 0===e||e.addEventListener("click",(()=>{this.processBtnCreate()}))}addListenerClickGenerateCars(){var e;null===(e=document.querySelector(".cars-generate__btn-generate"))||void 0===e||e.addEventListener("click",(()=>{this.processBtnGenerateCar()}))}addListenerClickBtnUpdate(e){const t=this.changeInputUpdate(e),n=document.querySelector(".cars-update__button"),r=()=>{t(),null==n||n.removeEventListener("click",r)};null==n||n.addEventListener("click",r)}addListenerClickRaceOrReset(){const e=document.querySelector(".cars-generate__btn-race"),t=document.querySelector(".cars-generate__btn-reset");null==e||e.addEventListener("click",(()=>{e.setAttribute("disabled",""),this.emitter.emit("raceStart")})),null==t||t.addEventListener("click",(()=>{e&&(e.removeAttribute("disabled"),this.emitter.emit("raceReset"))}))}}t.default=a},687:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function s(e){try{c(r.next(e))}catch(e){a(e)}}function o(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,o)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=i(n(844)),s=i(n(657));t.default=class{constructor(e,t,n){this.emitter=e,this.SERVER_URL=n,this.carName=s.default,this.carAdministrationView=new a.default(t),this.processDatalistElement(),this.emitter.subscribe("winnerBtnClick",(()=>this.carAdministrationView.hideBlockCarAdministration())),this.emitter.subscribe("garageBtnClick",(()=>this.carAdministrationView.visibleBlockCarAdministration())),this.emitter.subscribe("createdCar",(()=>r(this,void 0,void 0,(function*(){const e=yield this.loadCarsFromServer();this.carAdministrationView.addDatalistName(e)})))),this.emitter.subscribe("carRemove",(()=>r(this,void 0,void 0,(function*(){const e=yield this.loadCarsFromServer();this.carAdministrationView.addDatalistName(e)}))))}loadCarsFromServer(){return r(this,void 0,void 0,(function*(){try{const e=yield fetch(`${this.SERVER_URL}/garage`);if(e.ok)return yield e.json();throw new Error("Server connection error")}catch(e){throw new Error("Server connection error")}}))}processBtnCreate(){const e=document.querySelector(".cars-create__input"),t=document.querySelector(".cars-create__color");if(e.value){const n={name:e.value,color:t.value};this.addCarsServer(n),e.value=""}}addCarsServer(e){return r(this,void 0,void 0,(function*(){try{const t=yield fetch(`${this.SERVER_URL}/garage`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(201!==t.status)throw new Error("Failed to create car:");{const e=yield t.json();this.emitter.emit("createdCar",e)}}catch(e){throw new Error("Server connection error")}}))}updateCarServer(e){return r(this,void 0,void 0,(function*(){try{const t={name:e.name,color:e.color},n=yield fetch(`${this.SERVER_URL}/garage/${e.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(200===n.status)return yield n.json();throw new Error("Failed to update car.")}catch(e){throw new Error("Server connection error")}}))}processBtnGenerateCar(){for(let e=0;e<100;e+=1){const e={name:this.generateRandomName(),color:this.generateRandomColor()};this.addCarsServer(e)}}generateRandomColor(){return`hsla(${Math.floor(360*Math.random())}, 100%, 50%, 1)`}generateRandomName(){const{brand:e}=this.carName[0],{model:t}=this.carName[0],n=Math.floor(Math.random()*e.length),r=Math.floor(Math.random()*t.length);return`${e[n]} ${t[r]}`}processDatalistElement(){return r(this,void 0,void 0,(function*(){const e=yield this.loadCarsFromServer();this.carAdministrationView.addDatalistName(e)}))}changeInputUpdate(e){return this.carAdministrationView.addActiveInputUpdate(e.name),()=>(this.saveUpdateCarServer(e),this.carAdministrationView.disabledInputUpdate(),e)}saveUpdateCarServer(e){return r(this,void 0,void 0,(function*(){const t=document.querySelector(".cars-update__input"),n=document.querySelector(".cars-update__color"),r={id:e.id,name:t.value,color:n.value},i=yield this.updateCarServer(r);this.emitter.emit("updateCar",i)}))}}},844:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),n(8),t.default=class{constructor(e){this.createHTMLElementBlock(e)}createHTMLElementBlock(e){const t=document.createElement("div");t.classList.add("car-administration");const n=document.createElement("div");n.classList.add("cars-create");const r=document.createElement("div");r.classList.add("cars-update");const i=document.createElement("div");i.classList.add("cars-generate");const a=this.addInputCreate(n),s=this.addInputColor(a,"cars-create__color"),o=this.addBtn(s,"cars-create__button","CREATE"),c=this.addInputUpdate(r),d=this.addInputColor(c,"cars-update__color"),l=this.addBtn(d,"cars-update__button","UPDATE"),u=this.addBtn(i,"cars-generate__btn-race","RACE"),h=this.addBtn(u,"cars-generate__btn-reset","RESET"),p=this.addBtn(h,"cars-generate__btn-generate","GENERATE CARS");return t.appendChild(o),t.appendChild(l),t.appendChild(p),e.appendChild(t),e}addInputCreate(e){const t=document.createElement("input");return t.setAttribute("type","text"),t.setAttribute("list","car-list"),t.classList.add("cars-create__input"),e.appendChild(t),e}addDatalistName(e){const t=document.querySelector(".cars-create"),n=document.querySelector("#car-list");n&&n.remove();const r=document.createElement("datalist");r.id="car-list";for(let t=0;t<e.length;t+=1){const n=document.createElement("option");n.value=e[t].name,r.appendChild(n)}null==t||t.appendChild(r)}addInputColor(e,t){const n=document.createElement("input");return n.setAttribute("type","color"),n.classList.add(t),e.appendChild(n),e}addBtn(e,t,n){const r=document.createElement("button");return r.setAttribute("type","button"),r.classList.add(t),r.innerText=n,e.appendChild(r),e}addInputUpdate(e){const t=document.createElement("input");return t.setAttribute("type","text"),t.classList.add("cars-update__input"),t.setAttribute("disabled",""),e.appendChild(t),e}hideBlockCarAdministration(){const e=document.querySelector(".car-administration");null==e||e.classList.add("car-administration_hide")}visibleBlockCarAdministration(){const e=document.querySelector(".car-administration");null==e||e.classList.remove("car-administration_hide")}addActiveInputUpdate(e){const t=document.querySelector(".cars-update__input");t&&(t.value=e,t.removeAttribute("disabled"))}disabledInputUpdate(){const e=document.querySelector(".cars-update__input");e&&(e.value="",e.setAttribute("disabled",""))}}},858:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(41));class a extends i.default{constructor(e,t,n){super(e,t,n),this.addListenerClickGarage(),this.addListenerClickNextBtn(),this.addListenerClickPrevBtn(),this.emitter.subscribe("pageLoad",(()=>{this.addListenerClickBtnRemove(),this.addListenerClickBtnSelect(),this.addListenerClickDriveStart(),this.addListenerClickDriveStop()}))}addListenerClickGarage(){var e;null===(e=document.querySelector(".garage__btn"))||void 0===e||e.addEventListener("click",(()=>{this.emitter.emit("garageBtnClick")}))}addListenerClickNextBtn(){var e;null===(e=document.querySelector(".pagination__next"))||void 0===e||e.addEventListener("click",(()=>{this.addNextPage()}))}addListenerClickPrevBtn(){var e;null===(e=document.querySelector(".pagination__prev"))||void 0===e||e.addEventListener("click",(()=>{this.addPrevPage()}))}addListenerClickBtnRemove(){const e=document.querySelectorAll(".car__btn-remove");null==e||e.forEach(((e,t)=>{e.addEventListener("click",(()=>{this.processBtnRemove(t)}))}))}addListenerClickBtnSelect(){const e=document.querySelectorAll(".car__btn-select");null==e||e.forEach(((e,t)=>{e.addEventListener("click",(()=>{this.processBtnSelect(t)}))}))}addListenerClickDriveStart(){const e=document.querySelectorAll(".car__btn-start");null==e||e.forEach(((e,t)=>{e.addEventListener("click",(()=>{this.driveStart([t])}))}))}addListenerClickDriveStop(){const e=document.querySelectorAll(".car__btn-stop");null==e||e.forEach(((e,t)=>{e.addEventListener("click",(()=>{this.driveStop(t)}))}))}}t.default=a},41:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function s(e){try{c(r.next(e))}catch(e){a(e)}}function o(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,o)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=i(n(673));t.default=class{constructor(e,t,n){this.emitter=e,this.SERVER_URL=n,this.racingView=new a.default(t),this.addFirstPage(),this.emitter.subscribe("winnerBtnClick",(()=>this.racingView.hideBlocGarage())),this.emitter.subscribe("garageBtnClick",(()=>this.racingView.visibleBlocGarage())),this.emitter.subscribe("createdCar",(e=>this.addCarOnPage([e]))),this.emitter.subscribe("updateCar",(e=>this.racingView.updateCar(e))),this.emitter.subscribe("raceStart",(()=>this.raceStart())),this.emitter.subscribe("raceReset",(()=>this.raceReset()))}loadCarsFromServer(){return r(this,void 0,void 0,(function*(){try{const e=yield fetch(`${this.SERVER_URL}/garage`);if(e.ok)return yield e.json();throw new Error("Server connection error")}catch(e){throw new Error("Server connection error")}}))}removeCarServer(e){return r(this,void 0,void 0,(function*(){try{const t=yield fetch(`${this.SERVER_URL}/garage/${e}`,{method:"DELETE"});if(200===t.status){const n={color:"",id:Number(e),name:""};return this.emitter.emit("carRemove",n),t.ok}return console.error(`Failed to remove car: ${t.status}`),t.ok}catch(e){throw new Error("Server connection error")}}))}startOrStopEngine(e,t){return r(this,void 0,void 0,(function*(){const n=yield fetch(`${this.SERVER_URL}/engine?id=${e}&status=${t}`,{method:"PATCH"});if(200===n.status)return yield n.json();throw new Error(`${n.status}`)}))}getWinnerServer(e){return r(this,void 0,void 0,(function*(){const t=yield fetch(`${this.SERVER_URL}/winners/${e}`);if(200===t.status)return yield t.json();throw new Error(`${t.status}`)}))}createdWinnerServer(e){return r(this,void 0,void 0,(function*(){const t=yield fetch(`${this.SERVER_URL}/winners`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(201!==t.status)throw new Error(`${t.status}`);{const e=yield t.json();this.emitter.emit("createdWinner",e)}}))}updateWinnerServer(e){return r(this,void 0,void 0,(function*(){const t={wins:e.wins,time:e.time},n=yield fetch(`${this.SERVER_URL}/winners/${e.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(200!==n.status)throw new Error(`${n.status}`);{const e=yield n.json();this.emitter.emit("updateWinner",e)}}))}addFirstPage(){return r(this,void 0,void 0,(function*(){const e=yield this.loadCarsFromServer(),t=e.length>7?7:e.length;this.racingView.generateRaceField(e,0,t),this.racingView.changeQuantityCar(e),this.emitter.emit("pageLoad")}))}addCarOnPage(e){return r(this,void 0,void 0,(function*(){const t=yield this.loadCarsFromServer();document.querySelectorAll(".cars").length<7?(this.racingView.generateRaceField(e),this.racingView.changeQuantityCar(t),this.emitter.emit("pageLoad")):this.racingView.changeQuantityCar(t)}))}searchNumberPage(){const e=document.querySelector(".page-number__h3");return Number(null==e?void 0:e.innerHTML.split("#").pop())}addNextPage(){return r(this,void 0,void 0,(function*(){const e=yield this.loadCarsFromServer(),t=this.searchNumberPage();if(Math.ceil(e.length/7)<=t)return;this.racingView.cleanPageRacing();const n=7*t,r=Math.min(7*(t+1),e.length);this.racingView.generateRaceField(e,n,r),this.racingView.addNextPage(t+1),this.emitter.emit("pageLoad")}))}addPrevPage(){return r(this,void 0,void 0,(function*(){const e=yield this.loadCarsFromServer(),t=this.searchNumberPage();if(t-1==0)return;this.racingView.cleanPageRacing();const n=7*(t-2),r=n+7;this.racingView.generateRaceField(e,n,r),this.racingView.addNextPage(t-1),this.emitter.emit("pageLoad")}))}searchIdCar(e){return document.querySelectorAll(".cars")[e].className.split("-")[1]}processBtnRemove(e){return r(this,void 0,void 0,(function*(){const t=this.searchIdCar(e);if(yield this.removeCarServer(t)){const e=yield this.loadCarsFromServer(),t=this.searchNumberPage();this.racingView.cleanPageRacing();const n=1===t?0:7*(t-1),r=n+Math.min(e.length-n,7);this.racingView.generateRaceField(e,n,r),this.racingView.changeQuantityCar(e),this.emitter.emit("pageLoad")}}))}processBtnSelect(e){const t=this.searchIdCar(e),n=document.querySelectorAll(".car__name");if(n[e]){const r={id:Number(t),name:n[e].innerHTML,color:""};this.emitter.emit("clickBtnSelect",r)}}driveStart(e){return r(this,void 0,void 0,(function*(){const t=e.map((e=>{const t=this.searchIdCar(e);return this.startOrStopEngine(t,"started")})),n=yield Promise.all(t),r=this.addListenerTransition();this.switchEngineDriveMode(e);for(let t=0;t<n.length;t+=1){const i=document.querySelectorAll(".cars"),a=document.querySelectorAll(".car-icon"),s=i[e[t]].getBoundingClientRect(),o=a[e[t]].getBoundingClientRect(),c=s.left,d=s.right-s.left-(o.right-o.left)-c,l=(d/n[t].velocity).toFixed(2);this.racingView.addAnimationStartDrive(i[e[t]],d,l),r(a[e[t]],l,e[t])}}))}addListenerTransition(){let e=!1;return(t,n,r)=>{t.addEventListener("transitionend",(t=>{const i=t.elapsedTime;e||i!==Number(n)||(this.writeWinner(r,n),e=!0)}))}}writeWinner(e,t){return r(this,void 0,void 0,(function*(){const n={id:Number(this.searchIdCar(e)),wins:1,time:Number(t)};try{yield this.createdWinnerServer(n)}catch(e){const t=yield this.getWinnerServer(n.id);n.wins+=t.wins,n.time>t.time&&(n.time=t.time),this.updateWinnerServer(n)}}))}switchEngineDriveMode(e){return r(this,void 0,void 0,(function*(){e.map((e=>r(this,void 0,void 0,(function*(){try{const t=this.searchIdCar(e);yield this.startOrStopEngine(t,"drive")}catch(t){if(t instanceof Error&&"500"===t.message){const t=document.querySelectorAll(".cars"),n=document.querySelectorAll(".car-icon")[e].getBoundingClientRect(),r=20===n.left?0:n.left;this.racingView.addAnimationStartDrive(t[e],r)}}}))))}))}driveStop(e){return r(this,void 0,void 0,(function*(){const t=document.querySelectorAll(".cars"),n=this.searchIdCar(e);yield this.startOrStopEngine(n,"stopped"),this.racingView.addAnimationStopDrive(t[e])}))}raceStart(){const e=document.querySelectorAll(".cars");this.driveStart(Object.keys(e).map(Number))}raceReset(){document.querySelectorAll(".cars").forEach(((e,t)=>this.driveStop(t)))}}},673:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),n(108),t.default=class{constructor(e){this.createHTMLElementBlock(e)}createHTMLElementBlock(e){var t,n,r,i,a;const s=document.createElement("div");s.classList.add("garage");const o=this.addDiv(s,"garage-title"),c=this.addHTMLElement("H2","garage-title__h2","Garage"),d=this.addHTMLElement("H2","garage-title__cars","(0)");null===(t=o.firstChild)||void 0===t||t.appendChild(c),null===(n=o.firstChild)||void 0===n||n.appendChild(d);const l=this.addDiv(o,"page-number"),u=this.addHTMLElement("H3","page-number__h3","Page #1");null===(r=l.lastChild)||void 0===r||r.appendChild(u);const h=this.addDiv(l,"racing"),p=this.addDiv(h,"pagination"),m=this.createBtn("pagination__prev","Previous"),v=this.createBtn("pagination__next","Next");return null===(i=p.lastChild)||void 0===i||i.appendChild(m),null===(a=p.lastChild)||void 0===a||a.appendChild(v),e.appendChild(p),e}addDiv(e,t){const n=document.createElement("div");return n.classList.add(t),e.appendChild(n),e}addHTMLElement(e,t,n){const r=document.createElement(e);return r.classList.add(t),r.innerText=n,r}createBtn(e,t){const n=document.createElement("button");return n.setAttribute("type","button"),n.classList.add(e),n.innerText=t,n}hideBlocGarage(){const e=document.querySelector(".garage");null==e||e.classList.add("garage_hide")}visibleBlocGarage(){const e=document.querySelector(".garage");null==e||e.classList.remove("garage_hide")}generateRaceField(e,t=0,n=1){var r,i,a,s,o,c;const d=document.querySelector(".racing"),l=document.createDocumentFragment();for(let d=t;d<n;d+=1){const t=document.createElement("div");t.className=`cars car-${e[d].id}`;const n=this.addDiv(t,"car__title"),u=this.createBtn("car__btn-select","SELECT"),h=this.createBtn("car__btn-remove","REMOVE"),p=this.addHTMLElement("H4","car__name",`${e[d].name}`);null===(r=n.lastChild)||void 0===r||r.appendChild(u),null===(i=n.lastChild)||void 0===i||i.appendChild(h),null===(a=n.lastChild)||void 0===a||a.appendChild(p);const m=this.addDiv(t,"car-field"),v=this.createBtn("car__btn-start","A"),g=this.createBtn("car__btn-stop","B");g.setAttribute("disabled",""),null===(s=m.lastChild)||void 0===s||s.appendChild(v),null===(o=m.lastChild)||void 0===o||o.appendChild(g);const f=this.addHTMLElement("div","field-race",""),b=this.addCarIcon(f,e[d].color);null===(c=m.lastChild)||void 0===c||c.appendChild(b),l.appendChild(n),l.appendChild(m)}null==d||d.appendChild(l)}addCarIcon(e,t){const n=document.createElement("span");return n.classList.add("car-icon"),fetch("./icons/car.svg").then((e=>e.text())).then((e=>{n.innerHTML=e;const r=n.querySelector("svg");r&&(r.style.fill=t,r.style.width="100px",r.style.height="50px")})).catch((e=>{console.error("Not icon",e)})),e.appendChild(n),e}changeQuantityCar(e){document.querySelector(".garage-title__cars").innerHTML=`(${e.length})`}addNextPage(e){const t=document.querySelector(".page-number__h3");t&&(t.innerHTML=`Page #${e}`)}cleanPageRacing(){const e=document.querySelector(".racing");e&&(e.innerHTML="")}updateCar(e){const t=document.querySelector(`.car-${e.id}`),n=null==t?void 0:t.querySelector(".car__name"),r=null==t?void 0:t.querySelector("svg");r&&(r.style.fill=e.color),n&&(n.innerHTML=e.name)}addAnimationStartDrive(e,t,n="0.3"){const r=e.querySelector(".car-icon"),i=e.querySelector(".car__btn-start"),a=e.querySelector(".car__btn-stop");r&&(r.style.transition=`all ${n}s linear`,r.style.transform=`translateX(${t}px)`),null==i||i.setAttribute("disabled",""),null==a||a.removeAttribute("disabled")}addAnimationStopDrive(e){const t=e.querySelector(".car-icon"),n=e.querySelector(".car__btn-start"),r=e.querySelector(".car__btn-stop");null==t||t.removeAttribute("style"),null==r||r.setAttribute("disabled",""),null==n||n.removeAttribute("disabled")}}},897:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(87));class a extends i.default{constructor(e,t,n){super(e,t,n),this.addListenerClickWinners(),this.addListenerClickNextBtn(),this.addListenerClickPrevBtn()}addListenerClickWinners(){var e;null===(e=document.querySelector(".winner__btn"))||void 0===e||e.addEventListener("click",(()=>{this.emitter.emit("winnerBtnClick")}))}addListenerClickNextBtn(){var e;null===(e=document.querySelector(".winners-pagination__next"))||void 0===e||e.addEventListener("click",(()=>{this.changePageClick("next")}))}addListenerClickPrevBtn(){var e;null===(e=document.querySelector(".winners-pagination__prev"))||void 0===e||e.addEventListener("click",(()=>{this.changePageClick("prev")}))}}t.default=a},87:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function s(e){try{c(r.next(e))}catch(e){a(e)}}function o(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,o)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=i(n(48));t.default=class{constructor(e,t,n){this.emitter=e,this.SERVER_URL=n,this.winnersView=new a.default(e,t),this.addWinnersOnPage(),this.emitter.subscribe("winnerBtnClick",(()=>this.winnersView.visibleBlockWinners())),this.emitter.subscribe("garageBtnClick",(()=>this.winnersView.hideBlockWinners())),this.emitter.subscribe("createdWinner",(()=>this.updatePageWinner())),this.emitter.subscribe("updateWinner",(()=>this.updatePageWinner())),this.emitter.subscribe("updateCar",(()=>this.updatePageWinner())),this.emitter.subscribe("carRemove",(e=>r(this,void 0,void 0,(function*(){(yield this.deleteWinnerFromServer(e.id))&&this.updatePageWinner()}))))}loadWinnersFromServer(e={}){return r(this,void 0,void 0,(function*(){const t=`${this.SERVER_URL}/winners`,n=new URLSearchParams;e.page&&n.append("_page",String(e.page)),e.limit&&n.append("_limit",String(e.limit)),e.sort&&n.append("_sort",e.sort),e.order&&n.append("_order",e.order);const r=`${t}${`?${n.toString()}`||""}`,i=yield fetch(r);if(!i.ok)throw new Error(`Error: ${i.status}`);const a=i.headers.get("X-Total-Count"),s=a?Number(a):0;return{data:yield i.json(),totalCount:s}}))}deleteWinnerFromServer(e){return r(this,void 0,void 0,(function*(){return 200===(yield fetch(`${this.SERVER_URL}/winners/${e}`,{method:"DELETE"})).status}))}getCarServer(e){return r(this,void 0,void 0,(function*(){const t=yield fetch(`${this.SERVER_URL}/garage/${e}`);if(200===t.status)return yield t.json();throw new Error(`${t.status}`)}))}addWinnersOnPage(){window.addEventListener("load",(()=>{this.winnersView.addTableWinners(),this.addBodyTableWinners()}))}addBodyTableWinners(e=1,t="id",n="ASC"){return r(this,void 0,void 0,(function*(){const r={page:e,limit:10,sort:t,order:n},{data:i,totalCount:a}=yield this.loadWinnersFromServer(r);this.winnersView.fillBodyTableWinners(i,(e=>this.getCarServer(e))),this.winnersView.addTitleWinners(a),this.winnersView.changePage(e)}))}searchNumberPage(){const e=document.querySelector(".winners-page__number");return Number(null==e?void 0:e.innerHTML.split("#").pop())}updatePageWinner(){const e=this.searchNumberPage();this.addBodyTableWinners(e)}changePageClick(e){return r(this,void 0,void 0,(function*(){const t=this.searchNumberPage(),{totalCount:n}=yield this.loadWinnersFromServer({limit:10});"next"!==e?t>1&&this.addBodyTableWinners(t-1):Math.ceil(n/10)>t&&this.addBodyTableWinners(t+1)}))}}},48:function(e,t,n){var r,i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function s(e){try{c(r.next(e))}catch(e){a(e)}}function o(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,o)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),n(874),function(e){e.Number="header-table__number",e.ID="header-table__car-id",e.Car="header-table__car",e.Win="header-table__win",e.Name="header-table__name",e["Best Time (seconds)"]="header-table__time"}(r||(r={})),t.default=class{constructor(e,t){this.emitter=e,this.createHTMLElementBlock(t)}createHTMLElementBlock(e){var t,n,r,i,a;const s=document.createElement("div");s.classList.add("winners");const o=this.addDiv(s,"winners-title"),c=this.addHTMLElement("H2","winners-title__h2","Winners"),d=this.addHTMLElement("H2","winners-title__cars","(0)");null===(t=o.firstChild)||void 0===t||t.appendChild(c),null===(n=o.firstChild)||void 0===n||n.appendChild(d);const l=this.addDiv(o,"winners-page"),u=this.addHTMLElement("H3","winners-page__number","Page #1");null===(r=l.lastChild)||void 0===r||r.appendChild(u);const h=this.addDiv(s,"winners-list"),p=this.addDiv(h,"winners-pagination"),m=this.createBtn("winners-pagination__prev","Previous"),v=this.createBtn("winners-pagination__next","Next");return null===(i=p.lastChild)||void 0===i||i.appendChild(m),null===(a=p.lastChild)||void 0===a||a.appendChild(v),e.appendChild(s),e}addDiv(e,t){const n=document.createElement("div");return n.classList.add(t),e.appendChild(n),e}addHTMLElement(e,t,n){const r=document.createElement(e);return r.classList.add(t),r.innerText=n,r}createBtn(e,t){const n=document.createElement("button");return n.setAttribute("type","button"),n.classList.add(e),n.innerText=t,n}visibleBlockWinners(){const e=document.querySelector(".winners");null==e||e.classList.add("winners_visible")}hideBlockWinners(){const e=document.querySelector(".winners");null==e||e.classList.remove("winners_visible")}addTableWinners(){const e=document.createDocumentFragment(),t=document.createElement("thead");t.classList.add("header-table");const n=document.createElement("tr");Object.entries(r).forEach((([e,t])=>{const r=this.addHTMLElement("th",t,e);n.appendChild(r)})),t.appendChild(n),e.appendChild(t);const i=document.createElement("tbody");i.classList.add("body-table"),e.appendChild(i);const a=document.createElement("table");a.appendChild(e);const s=document.querySelector(".winners-list");null==s||s.appendChild(a)}fillBodyTableWinners(e,t){const n=document.createDocumentFragment();for(let i=0;i<e.length;i+=1){const a=document.createElement("tr"),s=Object.keys(r).map((n=>this.createCellElement(n,e[i],t,i)));Promise.all(s).then((e=>{e.forEach((e=>a.appendChild(e)))})),n.appendChild(a)}const i=document.querySelector(".body-table");i&&(i.innerHTML="",i.appendChild(n))}createCellElement(e,t,n,r){return i(this,void 0,void 0,(function*(){const i=yield n(t.id),a=document.createElement("td");switch(e){case"Number":a.innerText=`${r+1}`;break;case"ID":a.innerText=`${t.id}`;break;case"Car":yield this.addIconWinners(a,i.color,t.id);break;case"Win":a.innerText=`${t.wins}`;break;case"Name":a.innerText=i.name;break;case"Best Time (seconds)":a.innerText=`${t.time}`}return a}))}addTitleWinners(e){const t=document.querySelector(".winners-title__cars");t&&(t.innerHTML=`(${e})`)}changePage(e){const t=document.querySelector(".winners-page__number");t&&(t.innerHTML=`Page #${e}`)}addIconWinners(e,t,n){return i(this,void 0,void 0,(function*(){const r=document.createElement("span");r.classList.add(`winners__id=${n}`);try{const n=yield fetch("./icons/car.svg"),i=yield n.text();r.innerHTML=i;const a=r.querySelector("svg");a&&(a.style.fill=t,a.style.width="50px",a.style.height="20px"),e.appendChild(r)}catch(e){console.error("Not icon",e)}return e}))}}},607:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),n(427),new(r(n(887)).default)(function(){const e=document.querySelector("body"),t=document.createElement("header"),n=document.createElement("main"),r=document.createElement("button"),i=document.createElement("button");return t.classList.add("header"),n.classList.add("main"),r.classList.add("garage__btn"),r.innerText="TO GARAGE",r.setAttribute("type","button"),i.classList.add("winner__btn"),i.innerText="TO WINNER",i.setAttribute("type","button"),t.appendChild(r),t.appendChild(i),null==e||e.appendChild(t),null==e||e.appendChild(n),n}()).start()},477:(e,t,n)=>{e.exports=n.p+"icons/flag.png"},657:e=>{e.exports=JSON.parse('[{"brand":["Tesla","VW","Renault","BMW","Mersedes","Ford","Porsche","Dodge"],"model":["Polo","Model S","Model S Plaid","Chelenger","Laguna","Sprinter","Daily","MX-3","Cayen","911","LT","Megan","S60","Passat","X5","Probe","Mustang"]}]')}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var a=t[r]={id:r,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.exports}n.m=e,n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var i=r.length-1;i>-1&&!e;)e=r[i--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e})(),n.b=document.baseURI||self.location.href,n.nc=void 0,n(607)})();